function SlideMan(){this.shiftKeyDown=!1,this.ctrlKeyDown=!1,this.altKeyDown=!1,this.viewerIdAndViewerMap={};var e=this;window.addEventListener("resize",function(t){e.whenResize(t)})}try{var crossman=require("@sj-js/crossman"),ready=crossman.ready,getEl=crossman.getEl,newEl=crossman.newEl,getData=crossman.getData,SjEvent=crossman.SjEvent}catch(e){}try{module.exports=exports=SlideMan}catch(e){}SlideMan.prototype.detect=function(){var e=this;return ready(function(){e.initScrollView(),e.initSlideView()}),this},SlideMan.prototype.initScrollView=function(){for(var e,t=this,i=document.querySelectorAll("[data-type^=scrollview]"),n=0;n<i.length;n++)if(e=i[n],!e.isAdaptedView){e.isAdaptedView=!0;for(var d,l,o,r=0;r<e.children.length;r++){o=e.children[r];var s=o.getAttribute("data-type");switch(s){case"head":d=e.children[r];break;case"storage":l=e.children[r];for(var a=0,c=0;c<l.children.length;c++)a+=l.children[c].offsetWidth+20;l.parentNode.offsetWidth<a?l.style.width=a+50+"px":l.style.width="100%",e.scroller=newEl("div").addClass("assistant").attr("data-type","assistant").style("width:100%; overflow:auto;").add(l).appendTo(e).returnElement(),l.linkedScroller=e.scroller,l.executeEventMustDo=this.whenResize,getData().isMobile&&(l.linkedScroller.addEventListener("touchstart",function(e){t.whenTouchDownOnScrollview(e,this)}),l.linkedScroller.addEventListener("touchmove",function(e){t.whenTouchMoveOnScrollview(e,this)}),l.linkedScroller.addEventListener("touchend",function(e){t.whenTouchUpOnScrollview(e,this)}))}}}},SlideMan.prototype.initSlideView=function(){for(var e,t=this,i=document.querySelectorAll("[data-type^=slideview]"),n=0;n<i.length;n++)if(e=i[n],!e.isAdaptedView){e.isAdaptedView=!0;var d=e.getAttribute("data-type"),l=getEl(e).attr("data-viewer"),o=l?l:e.id?e.id:getEl(this.viewerIdAndViewerMap).getNewSeqId("slideviewBox");this.viewerIdAndViewerMap[o]=e;var r=void 0,s=void 0,a=void 0;if(e){for(var c,h=0;h<e.children.length;h++){c=e.children[h];var w=getEl(c).attr("data-type");switch(w){case"head":r=c;break;case"storage":a=c;break;case"tap":case"index":s=c}}var v=null;v=getEl(e).attr("data-event-slide"),v&&(e.executeEventSlide=new Function("viewer","menu","slide","slideId",v)),v=getEl(e).attr("data-event-menu-over"),v&&(e.executeEventMenuOver=new Function("viewer","menu","slide","slideId",v)),v=getEl(e).attr("data-event-menu-out"),v&&(e.executeEventMenuOut=new Function("viewer","menu","slide","slideId",v)),v=getEl(e).attr("data-event-menu-click"),v&&(e.executeEventMenuClick=new Function("viewer","menu","slide","slideId",v))}if(a){for(var u=0,f=0;f<a.children.length;f++){a.children[f].style.width=a.children[f].offsetWidth+"px",u+=a.children[f].offsetWidth+10;var v=a.children[f].getAttribute("data-event-slide");null!=v&&void 0!=v&&(a.children[f].executeEventSlide=new Function("viewer","menu","slide","slideId",v))}a.style.width=u+"px",e.slider=newEl("div").addClass("assistant").attr("data-type","assistant").style("width:100%; overflow:hidden;").add(a).appendTo(e).returnElement(),e.slider.viewer=e,e.storage=a,a.viewer=e,a.linkedSlider=e.slider,a.slideIdAndIndexMap={},a.slideIdAndMenuMap={},a.executeEventMustDo=this.whenResize,"slideview"==d&&(a.nowShowingChildIdx=0,e.slider.scrollLeft=a.children[a.nowShowingChildIdx].offsetWidth*a.nowShowingChildIdx,getData().isMobile?(a.linkedSlider.addEventListener("touchstart",function(e){t.whenTouchDownOnSlideview(e,this)}),a.linkedSlider.addEventListener("touchmove",function(e){t.whenTouchMoveOnSlideview(e,this)}),a.linkedSlider.addEventListener("touchend",function(e){t.whenTouchUpOnSlideview(e,this)})):(window.addEventListener("keydown",function(e){t.whenKeyDown(e)}),window.addEventListener("keyup",function(e){t.whenKeyUp(e)}),e.addEventListener("mousewheel",function(e){t.whenMouseWheel(e,this)}))),"slideview-auto"==d&&(e.timerSlideLeft=void 0,e.timerSlideRight=void 0,e.setSlideLeft=void 0,e.setSlideRight=void 0,e.setSlideRight=function(e){e.timerSlideLeft&&clearInterval(e.timerSlideLeft),e.timerSlideRight=setInterval(function(){e.slider.scrollLeft<=0&&e.setSlideLeft(e),e.slider.scrollLeft-=1},8)},e.setSlideLeft=function(e){clearInterval(e.timerSlideRight),e.timerSlideLeft=setInterval(function(){e.slider.scrollLeft>=e.slider.scrollWidth-e.slider.offsetWidth-10&&e.setSlideRight(e),e.slider.scrollLeft+=1},8)},e.setSlideRight(e))}if(s&&a){s.innerHTML+='<div data-type="optionRight" onclick="slideman.slideToRight(\''+o+"');\"><</div>",s.innerHTML+='<div data-type="optionLeft" onclick="slideman.slideToLeft(\''+o+"');\">></div>";var S=a.linkedViewerIndexList=newEl("div").attr("data-type","index-list").returnElement(),w=getEl(s).attr("data-type");switch(w){case"index":for(var f=0;f<a.children.length;f++){var p=a.children[f],g=getEl(p).attr("data-slide"),y=g?g:p.id?p.id:o+"storageData"+f;getEl(p).attr("data-slide",y).setStyle("height","100%"),a.slideIdAndIndexMap[y]=f;var E="o",M=newEl("div").attr("data-type","option").attr("onclick",'slideman.slideTo("'+o+'", '+f+");").add(E).appendTo(S).returnElement();a.slideIdAndMenuMap[y]=M}break;case"tap":for(var f=0;f<a.children.length;f++){var p=a.children[f],g=getEl(p).attr("data-slide"),y=g?g:p.id?p.id:o+"storageData"+f;getEl(p).attr("data-slide",y).setStyle("height","100%"),a.slideIdAndIndexMap[y]=f;for(var E,x=0;x<a.children[f].children.length;x++)"title"==a.children[f].children[x].getAttribute("data-type")&&(E=a.children[f].children[x]);var M=newEl("div").attr("data-type","option").attr("onclick",'slideman.slideTo("'+o+'", '+f+");").add(E).appendTo(S).returnElement();a.slideIdAndMenuMap[y]=M,this.checkEvent(e,M,p,y)}}this.expressNowSlide(a.viewer),getEl(s).add(S)}}},SlideMan.prototype.checkEvent=function(e,t,i,n){e.executeEventMenuOver&&getEl(t).addEventListener("mouseover",function(d){e.executeEventMenuOver(e,t,i,n)}),e.executeEventMenuOut&&getEl(t).addEventListener("mouseout",function(d){e.executeEventMenuOut(e,t,i,n)}),e.executeEventMenuClick&&getEl(t).addEventListener("click",function(d){e.executeEventMenuClick(e,t,i,n)})},SlideMan.prototype.whenDocumentScroll=function(e){},SlideMan.prototype.whenResize=function(e){for(var t,i=document.querySelectorAll("[data-type=assistant]"),n=0;n<i.length;n++){t=i[n];var d=t.children[0],l=t.parentNode,o=l.getAttribute("data-type");if(d&&("slideview"==o||"slideview-auto"==o)){for(var r=0,s=0;s<d.children.length;s++)d.children[s].style.width=t.offsetWidth+"px",r+=d.children[s].offsetWidth+10;d.style.width=r+"px","slideview"==o&&(t.scrollLeft=d.children[d.nowShowingChildIdx].offsetWidth*d.nowShowingChildIdx)}if(d&&"scrollview"==o){for(var r=0,s=0;s<d.children.length;s++)r+=d.children[s].offsetWidth+20;d.parentNode.offsetWidth<r?d.style.width=r+50+"px":d.style.width="100%"}}this.whenDocumentScroll(e)},SlideMan.prototype.whenTouchDownOnScrollview=function(e,t){t.slideviewStartPointX=e.touches[0].screenX,t.slideviewStartPointY=e.touches[0].screenY,t.slideviewStartScrollX=t.scrollLeft,t.slideviewStartScrollY=document.body.scrollTop},SlideMan.prototype.whenTouchMoveOnScrollview=function(e,t){t.slideviewEndPointX=e.touches[0].screenX,t.slideviewEndPointY=e.touches[0].screenY,t.movedDistanceX=Math.abs(t.slideviewEndPointX-t.slideviewStartPointX),t.movedDistanceY=Math.abs(t.slideviewEndPointY-t.slideviewStartPointY),!isOnDown&&t.movedDistanceX>5&&t.movedDistanceX>t.movedDistanceY&&e.stopPropagation()},SlideMan.prototype.whenTouchUpOnScrollview=function(e,t){},SlideMan.prototype.whenMouseWheel=function(e,t){if(this.shiftKeyDown){e.preventDefault();var i=t.storage;e.wheelDelta<0&&i.nowShowingChildIdx==i.children.length-1||e.wheelDelta>0&&0==i.nowShowingChildIdx||e.stopPropagation(),e.wheelDelta>0&&this.slideToRight(t),e.wheelDelta<0&&this.slideToLeft(t)}},SlideMan.prototype.whenKeyDown=function(e){16==e.keyCode&&(this.shiftKeyDown=!0)},SlideMan.prototype.whenKeyUp=function(e){16==e.keyCode&&(this.shiftKeyDown=!1),18==e.keyCode&&(this.altKeyDown=!1)},SlideMan.prototype.whenTouchDownOnSlideview=function(e,t){t.slideviewStartPointX=e.touches[0].screenX,t.slideviewStartPointY=e.touches[0].screenY,t.slideviewStartScrollX=t.scrollLeft,t.slideviewStartScrollY=document.body.scrollTop},SlideMan.prototype.whenTouchMoveOnSlideview=function(e,t){if(t.slideviewEndPointX=e.touches[0].screenX,t.slideviewEndPointY=e.touches[0].screenY,t.movedDistanceX=Math.abs(t.slideviewEndPointX-t.slideviewStartPointX),t.movedDistanceY=Math.abs(t.slideviewEndPointY-t.slideviewStartPointY),!isOnDown&&!isOnPaintDown&&t.movedDistanceX>5&&t.movedDistanceX>t.movedDistanceY){var i=t.slideviewEndPointX-t.slideviewStartPointX,n=10;-n>i&&t.firstChild.nowShowingChildIdx==t.firstChild.children.length-1||n<i&&0==t.firstChild.nowShowingChildIdx||e.stopPropagation(),e.preventDefault(),t.isOnTryToSlide=!0,isOnDown?this.slideToBack(t.firstChild):t.scrollLeft=t.slideviewStartScrollX+(t.slideviewStartPointX-t.slideviewEndPointX)}},SlideMan.prototype.whenTouchUpOnSlideview=function(e,t){if(t.isOnTryToSlide){t.isOnTryToSlide=!1;var i=t.slideviewEndPointX-t.slideviewStartPointX,n=t.offsetWidth/4;-n>i?this.slideToLeft(t.viewer):n<i?this.slideToRight(t.viewer):this.slideToBack(t.viewer)}},SlideMan.prototype.slideToRight=function(e){"string"==typeof e&&(e=this.viewerIdAndViewerMap[e]);var t=e.storage;this.slideTo(e,t.nowShowingChildIdx-1)},SlideMan.prototype.slideToLeft=function(e){"string"==typeof e&&(e=this.viewerIdAndViewerMap[e]);var t=e.storage;this.slideTo(e,t.nowShowingChildIdx+1)},SlideMan.prototype.slideToBack=function(e){"string"==typeof e&&(e=this.viewerIdAndViewerMap[e]);var t=e.storage;t.onSlideToBack=!0,this.slideTo(e,t.nowShowingChildIdx)},SlideMan.prototype.slideTo=function(e,t){"string"==typeof e&&(e=this.viewerIdAndViewerMap[e]);var i=e.storage;if("string"==typeof t)t=i.slideIdAndIndexMap[t];else if(i.children.length<=t)return void this.slideTo(e,i.nowShowingChildIdx);var n,d=this,l=i.parentNode,o=i.children[t];if(o){var r=getEl(o).attr("data-slide"),s=i.slideIdAndMenuMap[r],a=o.offsetWidth*t,c=50;l.scrollLeft<a?l.onSlide||(n=setInterval(function(){l.onSlide=!0,l.scrollLeft<a?l.scrollLeft+=c:(l.scrollLeft=a,i.nowShowingChildIdx=t,clearInterval(n),d.expressNowSlide(i.viewer),l.onSlide=!1,i.onSlideToBack||(l.parentNode.executeEventSlide&&l.parentNode.executeEventSlide(e,s,o,r),i.children[t].executeEventSlide&&i.children[t].executeEventSlide(e,s,o,r)),i.onSlideToBack=!1)},8)):l.scrollLeft>a&&(l.onSlide||(n=setInterval(function(){l.onSlide=!0,l.scrollLeft>a?l.scrollLeft-=c:(l.scrollLeft=a,i.nowShowingChildIdx=t,clearInterval(n),d.expressNowSlide(i.viewer),l.onSlide=!1,i.onSlideToBack||(l.parentNode.executeEventSlide&&l.parentNode.executeEventSlide(e,s,o,r),i.children[t].executeEventSlide&&i.children[t].executeEventSlide(e,s,o,r)),i.onSlideToBack=!1)},8)))}},SlideMan.prototype.expressNowSlide=function(e){for(var t=e.storage,i=t.linkedViewerIndexList.children,n=t.nowShowingChildIdx,d=0;d<i.length;d++)getEl(i[d]).removeClass("now-slide"),d==n&&getEl(i[d]).addClass("now-slide")};